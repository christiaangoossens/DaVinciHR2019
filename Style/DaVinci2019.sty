% DA VINCI LaTeX styling
% Made by Christiaan Goossens during the Da Vinci rebranding of 2019.
% You should leave the full folder in your LaTeX project, and not rename it.
% Please use this package in your file with: \usepackage{Style/DaVinci2019}

% You will need to run this with LuaLaTex

\ProvidesPackage{Style/DaVinci2019}

% Packages
\usepackage{fontspec}
\usepackage{xcolor}
\usepackage{titlesec}
\usepackage{titling}
\usepackage[lmargin=0.6in,rmargin=0.6in,top=1.7in,bottom=1.4in,headsep=0.55in,headheight=0.5in]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancy}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{lastpage}
\usepackage{microtype}
\usepackage[modulo]{lineno}

% Variables
\newcommand\DEStitle{Default}
\newcommand\DESsubtitle{}
\newcommand\DESfooter{}
\newcommand\setTitle[1]{\renewcommand\DEStitle{#1}}
\newcommand\setSubtitle[1]{\renewcommand\DESsubtitle{#1}}
\newcommand\setFooter[1]{\renewcommand\DESfooter{#1}}

% Colors
\definecolor{main}{RGB}{174,32,46}
\definecolor{accent1}{RGB}{199,25,24}
\definecolor{accent2}{RGB}{104,49,106}
\definecolor{grey}{RGB}{87,87,86}

% Font
\setmainfont
	[
  		Path = Style/,
  		Ligatures = TeX,
		BoldFont = Cabin-Bold.otf, 
		BoldItalicFont = Cabin-BoldItalic.otf, 
		ItalicFont = Cabin-Italic.otf
	]
	{Cabin-Regular.otf}
\newfontfamily{\cabin}
	[
  		Path = Style/,
  		Ligatures = TeX,
		BoldFont = Cabin-Bold.otf, 
		BoldItalicFont = Cabin-BoldItalic.otf, 
		ItalicFont = Cabin-Italic.otf
	]
	{Cabin-Regular.otf}
\newfontfamily{\arvo}
	[
  		Path = Style/,
  		Ligatures = TeX,
		BoldFont = Arvo-Bold.ttf, 
		BoldItalicFont = Arvo-BoldItalic.ttf, 
		ItalicFont = Arvo-Italic.ttf
	]
	{Arvo-Regular.ttf}

% Disable alinea identation
\setlength{\parindent}{0pt}

% Provide headers
\titleformat*{\section}{\Large\arvo\color{main}}
\titleformat*{\subsection}{\large\cabin\color{main}}
\titleformat*{\subsubsection}{\cabin\color{main}}

\titlespacing*{\section} {0pt}{3.5ex plus 1ex minus .2ex}{3.3ex plus .2ex}
\titlespacing*{\subsection} {0pt}{3.25ex plus 1ex minus .2ex}{2.5ex plus .2ex}

% Provide page layout
\fancyhf{} % clear all fields
\rhead{
% Header picture positioning
\begin{tikzpicture}[remember picture,overlay]
  \node[anchor=north east,inner sep=0pt] at ($(current page.north east)$) {
     \includegraphics[scale=1.2]{Style/logo-full.pdf}
  };
\end{tikzpicture}
} 
\lhead{\color{grey}{\arvo \LARGE \textbf{\DEStitle}}\\ 
\smallskip
{\cabin \large \DESsubtitle}}
\cfoot{
% Footer picture positioning
\begin{tikzpicture}[remember picture,overlay]
  \node[anchor=south west,inner sep=0pt] at ($(current page.south west) + (0.85cm,0)$) {
     \includegraphics{Style/footer-full.pdf}
  };
\end{tikzpicture}
}

% Use the command \enableFooter to toggle the footer with text and page numbering
\newcommand{\enableFooter}{
\renewcommand{\footrulewidth}{1pt}
\renewcommand{\footrule}{\color{grey} \vbox to 0pt{\hbox
to\headwidth{\dotfill}\vss}}
\lfoot{\color{grey} \small \DESfooter}
\rfoot{\color{grey} \small Page \thepage\ of \pageref{LastPage}}
}

\rfoot{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% And we're done! :)